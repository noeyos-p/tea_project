<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>메모 작성</title>
    <link rel="stylesheet" th:href="@{/css/tea-memo.css}">
</head>
<body>
<form id="memoForm" th:action="@{/userdata/memo/{id}(id=${userData.id})}" method="post" th:object="${userData}">
    <!-- userDataId 전달용 hidden input -->
    <input type="hidden" th:field="*{id}" />

    <div class="page">
        <div class="topbar">
            <a class="back" href="#" aria-label="뒤로 가기">
                <!-- SVG 아이콘 -->
            </a>
        </div>
    </div>

    <div class="container"
         th:with="
           alreadyParam=${param.already} != null,
           alreadyModel=${already} == true,
           alreadyWritten=${alreadyParam} or ${alreadyModel}
         "
         th:attr="data-already=${alreadyWritten}">
        <div class="main-title">
            <p class="mt-1">차를 마시면 기분이 한결 나아질거에요.</p>
            <p class="mt-2">천천히 차를 마시면서 오늘의 기분이나 상태를<br> 함께 기록해보세요</p>
        </div>

        <div class="sub-label">무엇이든 입력하세요 :)</div>

        <!-- 메모 입력 -->
        <textarea id="memoField" class="text-box" th:field="*{memo}" placeholder="오늘의 기분이나 상태를 적어보세요 :)"></textarea>

        <!-- 저장 버튼 -->
        <button id="saveBtn" class="save-btn" type="submit">저장하기</button>

        <!-- 메시지 표시 -->
        <div id="memoNotice" class="message"
             th:if="${message}"
             th:text="${message}">
        </div>

        <!-- 마이페이지 이동 -->
        <div class="mypage-go">
            <a th:href="@{/userdata/mypage/memo/main}" class="mypage-link">마이페이지로 이동</a>
        </div>

        <hr>

        <!-- 추천 차 정보 -->
        <div class="recommend">
            <span>이</span>
            <span class="tea" th:text="${tea.name}">페퍼민트</span>
            <span>제품을 추천드려요</span>
        </div>

        <div class="tea-img">
            <img src="/TeaProject/photo/페퍼민트.png" alt="추천 차 이미지">
        </div>

        <div class="tea-name">
            <p th:text="${tea.name} + ' 티백'">트와이닝 페퍼민트 티백</p>
        </div>
        <button class="buy-btn" type="button">구매하러 가기</button>

        <hr>

        <div class="recommend">
            <span class="tea" th:text="${tea.name}">페퍼민트</span>
            <span>를 판매하는 내 근처 카페 찾아보기</span>
        </div>
    </div>
</form>
<form th:action="@{/cafe/map}" method="post" class="search-box">
    <!-- CSRF 토큰 -->
    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />

    <!-- tea.name 자동 전달 -->
    <input type="hidden" name="keyword" th:value="${tea.name}" />

    <!-- 주소 입력 (readonly, Daum 주소 검색 API 사용) -->
    <input type="text" id="address" name="address" placeholder="주소를 입력하세요." readonly required />

    <!-- 주소 검색 버튼 (돋보기 클릭 시 Daum API 호출) -->
    <button type="button" onclick="searchAddress()" aria-label="주소 검색">
        <svg class="search" viewBox="0 0 24 24" width="24" height="24">
            <path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5
                     6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 5
                     1.49-1.49-5-5Zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5
                     14 7.01 14 9.5 11.99 14 9.5 14Z"
                  fill="currentColor"/>
        </svg>
    </button>

    <!-- 실제 POST 제출 버튼 -->
    <button type="submit">검색</button>
</form>

<!-- Daum 주소 검색 스크립트 -->
<script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
<script>
    function searchAddress() {
        new daum.Postcode({
            oncomplete: function(data) {
                document.getElementById('address').value = data.address;
            }
        }).open();
    }
</script>


        <!-- 검색박스 -->
        <!--<div class="search-box">
            <input type="text" placeholder=" 주소를 입력하세요." />
            <button type="button" aria-label="검색">
                &lt;!&ndash; 돋보기 아이콘 &ndash;&gt;
                <svg class="search" viewBox="0 0 24 24" width="24" height="24">
                    <path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5
                             6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 5
                             1.49-1.49-5-5Zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5
                             14 7.01 14 9.5 11.99 14 9.5 14Z"
                          fill="currentColor"/>
                </svg>
            </button>
        </div>-->

</body>
</html>
